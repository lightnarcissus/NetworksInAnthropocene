<!DOCTYPE html>
<head>
<link href="https://fonts.googleapis.com/css?family=Abril+Fatface|Quicksand|Roboto+Mono" rel="stylesheet"> 
<meta charset="utf-8">
<style type="text/css">
	html{ width:100%; height:100%; }
body{ width:100%; height:100%;
  font-family: 'Quicksand', sans-serif;
  font-weight: normal;
  color: #999;
  background-color: #eee;
}

form {
}

div {
  clear: both;
}

label {
  width: 200px;
  border-radius: 3px;
  border: 1px solid #D1D3D4
}
.radio-toolbar input[type="radio"] {
    display:none;
}

.radio-toolbar label {
    display:inline-block;
    background-color:#ddd;
    padding:4px 11px;
    font-family:Arial;
    font-size:16px;
}

.radio-toolbar input[type="radio"]:checked + label {
    background-color:#bbb;
}

div.title
{
  font-family: 'Abril Fatface', cursive;
    color: #000000;
    font-size: 40px;
}

div.btn {
  -webkit-border-radius: 28;
  -moz-border-radius: 28;
  border-radius: 28px;
  -webkit-box-shadow: 0px 1px 3px #666666;
  -moz-box-shadow: 0px 1px 3px #666666;
  box-shadow: 0px 1px 3px #666666;
  font-family: 'Roboto Mono', monospace;
  color: #ffffff;
  font-size: 20px;
  background: #000000;
  padding: 10px 20px 10px 20px;
  text-decoration: none;
}

div.btn:hover {
  background: #5eff00;
  text-decoration: none;
}

</style>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
</head>
<body>

<div class="title" id="title" align="center">
Networks in Anthropocene
</div>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://d3js.org/topojson.v1.min.js"></script>
  <!-- I recommend you host this file on your own, since this will change without warning -->
  <div class="top-info" id="top-info">
  <script src="datamaps.world.hires.min.js"></script>
 
  <div class="btn" id="btn" align="center" style="width:10%;height:10%;" onclick="advanceTurn();">
   ADVANCE
   </div>
   <div class="turn-count" id="turn-count" align="right">
   2016
   </div>
</div>
<div id="main-container" style="position:absolute;width:100%;height:100%;">
 <div class="radio-toolbar" align="left">  
    <input type="radio" id="radio1" name="radios" value="all" checked>
    <label for="radio1">Network</label>

    <input type="radio" id="radio2" name="radios"value="false">
    <label for="radio2">Open</label>

    <input type="radio" id="radio3" name="radios" value="true">
    <label for="radio3">Archived</label>


</div>
  <div id="container1" style="position:relative;width:100%;height:100%;background:#0283f4;">
 
  </div>
 
  </div>
  
  <!-- Add as many pattern definitions (defs) as you'd like, make sure to include an ID -->
<svg xmlns="http://www.w3.org/2000/svg" version="1.1"
     xmlns:xlink="http://www.w3.org/1999/xlink">

       
    <!-- Horizontal Stripe pattern -->
    <defs>
        <pattern id="horizontal-stripe"
                 width="4" height="4"
                 patternUnits="userSpaceOnUse">
             <line x1="0" y1="2" x2="4" y2="2" stroke="blue" />
        </pattern>
    </defs>
       
       
      <!-- Vertical Stripe pattern -->   
    <defs>
        <pattern id="vertical-stripe"
                 width="4" height="4"
                 patternUnits="userSpaceOnUse">
             <line x1="2" y1="0" x2="2" y2="4" stroke="green" />
        </pattern>
    </defs>
    
     <!-- Diagonal Stripe pattern -->
    <defs>
        <pattern id="diagonal-stripe"
                 patternTransform="rotate(45)"
                 width="4" height="4"
                 patternUnits="userSpaceOnUse">
             <line x1="2" y1="0" x2="2" y2="4" stroke="#bada55" stroke-width="2" />
        </pattern>
    </defs>

      <!-- Circles pattern --> 
    <defs>
        <pattern id="circles"
                 width="4" height="4"
                 patternUnits="userSpaceOnUse">
                   <circle cx="2.5" cy="2.5" r="1.3" fill="green" />
      </pattern>
    </defs>
      
       <!-- Gradient pattern. Wouldn't really recommend this one. -->
     <linearGradient id="gradient">
        <stop offset="5%" stop-color="#F60" />
        <stop offset="95%" stop-color="#FF6" />
     </linearGradient>
       
     <!-- Triangles pattern -->  
     <pattern id="triangle"
       width="8" height="8"
       patternUnits="userSpaceOnUse">
         <polygon points="3,0 6,6 0,6" fill="purple"/>
      </pattern>
</svg>
     
     <script>

     var data= [['ABW',88.661226932496],
['AND',96.91],
['AFG',8.26],
['AGO',12.4],
['ALB',63.252932696931],
['ARB',39.5261540659397],
['ARE',91.2434057753709],
['ARG',69.40092102179],
['ARM',58.2493322231746],
['ASM',],
['ATG',65.2],
['AUS',84.560519347399],
['AUT',83.9263],
['AZE',77],
['BDI',4.86622446359511],
['BEL',85.0529],
['BEN',6.787702956098],
['BFA',11.387646166247],
['BGD',14.4],
['BGR',56.6563],
['BHR',93.4783011354165],
['BHS',78],
['BIH',65.065502803344],
['BLR',62.230360906803],
['BLZ',41.589999999835],
['BMU',98.3236096537251],
['BOL',45.1],
['BRA',59.079477910505],
['BRB',76.11],
['BRN',71.2],
['BTN',39.8],
['BWA',27.5],
['CAF',4.563264351542],
['CAN',88.47],
['CEB',68.1565862177866],
['CHE',87.97],
['CHI',],
['CHL',64.289],
['CHN',50.3],
['CIV',21],
['CMR',20.6801476606263],
['COG',7.61597466209],
['COL',55.9049725142924],
['COM',7.459161385649],
['CPV',43.019626357101],
['CRI',59.7629501371681],
['CSS',51.9169995201878],
['CUB',31.107970210145],
['CUW',],
['CYM',77],
['CYP',71.7159],
['CZE',81.2986],
['DEU',87.5898],
['DJI',11.9224314345],
['DMA',67.6],
['DNK',96.3305],
['DOM',51.9302327383135],
['DZA',38.2],
['EAP',44.9820489707828],
['EAR',29.7923425468531],
['EAS',49.8247157803774],
['ECA',59.9320644594073],
['ECS',71.7441292126694],
['ECU',48.9404337892669],
['EGY',35.9],
['EMU',80.280283969454],
['ERI',1.083733115675],
['ESP',78.6896],
['EST',88.4066],
['ETH',11.6],
['EUU',79.6258146075023],
['FCS',14.98630874699],
['FIN',92.6513],
['FJI',46.32872894627],
['FRA',84.6945],
['FRO',94.2],
['FSM',31.501081275309],
['GAB',23.5],
['GBR',92.0003],
['GEO',45.1583744140752],
['GHA',23.478128435343],
['GIB',],
['GIN',4.7],
['GMB',17.119820502123],
['GNB',3.540706917021],
['GNQ',21.319999985207],
['GRC',66.835],
['GRD',53.81],
['GRL',67.600443481006],
['GTM',27.100000000275],
['GUM',73.139999947043],
['GUY',38.2],
['HIC',81.0147435830839],
['HKG',84.9483529634062],
['HND',20.356867428881],
['HPC',12.1335183726839],
['HRV',69.8031],
['HTI',12.197766377036],
['HUN',72.8347],
['IBD',42.5005997446169],
['IBT',37.1141533061658],
['IDA',22.1328336912874],
['IDB',35.0408617964624],
['IDN',21.9760677113476],
['IDX',14.8570226267095],
['IMN',],
['IND',26],
['INX',],
['IRL',80.1224],
['IRN',44.082875016875],
['IRQ',17.22],
['ISL',98.2],
['ISR',78.88517910353],
['ITA',65.5716],
['JAM',43.1758971872],
['JOR',53.4],
['JPN',93.329411063737],
['KAZ',72.8660129673921],
['KEN',45.6228006060586],
['KGZ',30.247042775311],
['KHM',19],
['KIR',12.99748389414],
['KNA',75.7],
['KOR',89.8962557995106],
['KSV',],
['KWT',82.0791147627883],
['LAC',53.8839339917845],
['LAO',18.2],
['LBN',74],
['LBR',5.903867602799],
['LBY',19.016079781565],
['LCA',52.35],
['LCN',54.4583843034657],
['LDC',12.628601218278],
['LIC',9.46034205257496],
['LIE',96.6411950959488],
['LKA',29.988737549341],
['LMC',28.6320615312121],
['LMY',36.7986475240125],
['LSO',16.071707703394],
['LTE',54.0592557700003],
['LTU',71.378],
['LUX',97.3341],
['LVA',79.2006],
['MAC',77.6001318608868],
['MAF',],
['MAR',57.08],
['MCO',93.3633020180933],
['MDA',49.8369395415],
['MDG',4.173972190007],
['MDV',54.461955146942],
['MEA',43.707533366815],
['MEX',57.4310429923633],
['MHL',19.282441803511],
['MIC',39.7963632949121],
['MKD',70.3802],
['MLI',10.33692498389],
['MLT',76.184],
['MMR',21.8],
['MNA',38.2062538479483],
['MNE',64.564993139872],
['MNG',21.4360311065255],
['MNP',],
['MOZ',9],
['MRT',15.199126690825],
['MUS',50.1393184766711],
['MWI',9.2981483471244],
['MYS',71.0640678111957],
['NAC',75.9372515632806],
['NAM',22.3070147912325],
['NCL',74.00175279141],
['NER',2.220165349673],
['NGA',47.442550294429],
['NIC',19.704291498993],
['NLD',93.0965],
['NOR',96.8103],
['NPL',17.58161800656],
['NRU',],
['NZL',88.22288881795],
['OED',77.243487456501],
['OMN',74.174165970433],
['OSS',40.3955638254411],
['PAK',18],
['PAN',51.2054249948687],
['PER',40.9],
['PHL',40.7],
['PLW',],
['PNG',7.9],
['POL',67.997],
['PRE',21.0710908041732],
['PRI',79.46876882531],
['PRK',],
['PRT',68.6329],
['PRY',44.381596919184],
['PSS',29.7828414639424],
['PST',79.7749533624375],
['PYF',64.560209747212],
['QAT',92.8848264535481],
['ROU',55.7632],
['RUS',73.41],
['RWA',18],
['SAS',23.6279411151014],
['SAU',69.6162358014004],
['SDN',26.614928545846],
['SEN',21.690264133037],
['SGP',82.103],
['SLB',10.000464982561],
['SLE',2.5],
['SLV',26.915075328277],
['SMR',],
['SOM',1.76],
['SRB',65.3170254003801],
['SSA',22.384664533935],
['SSD',17.9297872340426],
['SSF',22.3880597098621],
['SST',41.9345509745761],
['STP',25.822248798856],
['SUR',42.763827782511],
['SVK',85.019514056785],
['SVN',73.0987],
['SWE',90.6102],
['SWZ',30.382700656117],
['SXM',],
['SYC',58.118697567706],
['SYR',29.979797235769],
['TCA',],
['TCD',2.70000000055],
['TEA',44.9820489707828],
['TEC',60.7187464806964],
['TGO',7.12],
['THA',39.3161267365004],
['TJK',18.980000000495],
['TKM',14.996774820447],
['TLA',54.7037176765572],
['TMN',37.9589815831978],
['TLS',13.4],
['TON',44.999518833326],
['TSA',23.6279411151014],
['TSS',22.3880597098621],
['TTO',69.198470608693],
['TUN',48.519835991689],
['TUR',53.7449791423583],
['TUV',42.7],
['TZA',5.355144064127],
['UGA',19.221099634407],
['UKR',49.26],
['UMC',52.1378691585815],
['URY',64.6],
['USA',74.55],
['UZB',42.8],
['VCT',51.77],
['VEN',61.869248094278],
['VGB',],
['VIR',54.839137296],
['VNM',52.720000000055],
['VUT',22.351404582536],
['PSE',57.42419241388],
['WLD',43.9983147914322],
['WSM',25.407009766593],
['YEM',25.09951439988],
['ZAF',51.919115722747],
['COD',3.799999507273],
['ZMB',21],
['ZWE',16.36],
];

var dataset = {};

var onlyValues = data.map(function(obj){ return obj[1]; });
    var minValue = Math.min.apply(null, onlyValues),
            maxValue = Math.max.apply(null, onlyValues);
    // create color palette function
    // color can be whatever you wish
    var paletteScale = d3.scale.linear()
            .domain([2,99])
            .range(["#EFEFFF","#02386F"]); // blue color
    // fill dataset in appropriate format
    data.forEach(function(item){ //
        // item example value ["USA", 70]
        var iso = item[0],
                value = item[1];
        dataset[iso] = { numberOfThings: value, fillColor: paletteScale(value) };
    });

    
      var election = new Datamap({
        scope: 'world',
        element: document.getElementById('container1'),
        projection: 'mercator',
        
        fills: {
          defaultFill: '#f0af0a',
          horizontalStripe: 'url(#horizontal-stripe)',
          diagonalStripe: 'url(#diagonal-stripe)',
          verticalStripe: 'url(#vertical-stripe)',
          circles: 'url(#circles)',
          gradient: 'url(#gradient)',
          triangle: 'url(#triangle)'
        },
        
        data: dataset,
        done: function(datamap) {
            datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
                console.log(geography.properties.iso);
                //election.updateChoropleth({USA: {fillKey: 'circles'},})
                changeOptions(geography.properties.iso,election);
            });
        },
        bubblesConfig: {
        borderWidth: 2,
        borderOpacity: 1,
        borderColor: '#FFFFFF',
        popupOnHover: true, // True to show the popup while hovering
        radius: null,
        popupTemplate: function(geography, data) {
                // don't show tooltip if country don't present in dataset
                if (!data) { return ; }
                // tooltip content
                return ['<div class="hoverinfo">',
                    '<strong>', geo.properties.name, '</strong>',
                    '<br>Count: <strong>', data.numberOfThings, '</strong>',
                    '</div>'].join('');
            },
        fillOpacity: 0.75,
        animate: true,
        highlightOnHover: true,
        highlightFillColor: '#FC8D59',
        highlightBorderColor: 'rgba(250, 15, 160, 0.2)',
        highlightBorderWidth: 2,
        highlightBorderOpacity: 1,
        highlightFillOpacity: 0.85,
        exitDelay: 100, // Milliseconds
        key: JSON.stringify
    },
    arcConfig: {
      strokeColor: 'red',
      strokeWidth: 1,
      arcSharpness: 1,
      animationSpeed: 600, // Milliseconds
      popupOnHover: true, // True to show the popup while hovering
      popupTemplate: function(geography, data) { // This function should just return a string
        // Case with latitude and longitude
        if ( ( data.origin && data.destination ) && data.origin.latitude && data.origin.longitude && data.destination.latitude && data.destination.longitude ) {
          return '<div class="hoverinfo"><strong>Cable</strong><br>Origin: ' + JSON.stringify(data.origin) + '<br>Destination: ' + JSON.stringify(data.destination) + '</div>';
        }
        // Case with only country name
        else if ( data.origin && data.destination ) {
          return '<div class="hoverinfo"><strong>Cable</strong><br>' + data.origin + ' -> ' + data.destination + '</div>';
        }
        // Missing information
        else {
          return '';
        }
      }
    },
    geographyConfig: {
            popupTemplate: function(geo, data) {
                return ['<div class="hoverinfo"><strong>',
                        'Network Connectivity in ' + geo.properties.name,
                        ': ' + data.numberOfThings,
                        '</strong></div>'].join('');
            }
        }
      })
      var bombs = [{
        name: 'Joe 4',
        radius: 25,
        yield: 400,
        country: 'USSR',
        fillKey: 'RUS',
        significance: 'First fusion weapon test by the USSR (not "staged")',
        date: '1953-08-12',
        latitude: 50.07,
        longitude: 78.43
      },{
        name: 'RDS-37',
        radius: 40,
        yield: 1600,
        country: 'USSR',
        fillKey: 'RUS',
        significance: 'First "staged" thermonuclear weapon test by the USSR (deployable)',
        date: '1955-11-22',
        latitude: 50.07,
        longitude: 78.43

      },{
        name: 'Tsar Bomba',
        radius: 75,
        yield: 50000,
        country: 'USSR',
        fillKey: 'RUS',
        significance: 'Largest thermonuclear weapon ever tested—scaled down from its initial 100 Mt design by 50%',
        date: '1961-10-31',
        latitude: 73.482,
        longitude: 54.5854
      }
    ];
    //draw bubbles for bombs

election.bubbles(bombs, {
    popupTemplate: function (geo, data) {
            return ['<div class="hoverinfo">' +  data.name,
            '<br/>Payload: ' +  data.yield + ' kilotons',
            '<br/>Country: ' +  data.country + '',
            '<br/>Date: ' +  data.date + '',
            '</div>'].join('');
    }
});


// Arcs coordinates can be specified explicitly with latitude/longtitude,
// or just the geographic center of the state/country.

election.arc([
  {
    origin: 'CAN',
    destination: 'IND'
  },
  {
    origin: 'CHN',
    destination: 'RUS'
  },

  //PIPELINE
  {
    origin:
    {
      latitude:25.132297,
      longitude:62.325026
    },
    destination:
    {
      latitude:1.490780,
      longitude:124.839644
    }
  },
  {
  origin:
  {
    latitude:1.490780,
    longitude:124.839644
  },
  destination:
  {
    latitude:13.419193,
    longitude:144.645958
  }
  },
//CABLE
 {
  origin:'SOM',
  destination:'TZA'
},
  {
    origin: 'BRA',
    destination: 'USA',
      options: {
        strokeWidth: 20,
        strokeColor: 'rgba(100, 10, 200, 0.4)',
        greatArc: true
      }
  },
  {
      origin: {
          latitude: 40.639722,
          longitude: -73.778889
      },
      destination: {
          latitude: 37.618889,
          longitude: -122.375
      }
  },
  {
      origin: {
          latitude: 30.194444,
          longitude: -97.67
      },
      destination: {
          latitude: 25.793333,
          longitude: -80.290556
      },
      options: {
        strokeWidth: 2,
        strokeColor: 'rgba(100, 10, 200, 0.4)',
        greatArc: true
      }
  },
  {
      origin: {
          latitude: 39.861667,
          longitude: -104.673056
      },
      destination: {
          latitude: 35.877778,
          longitude: -78.7875
      }
  }
],  {strokeWidth: 1, arcSharpness: 1.4});

console.log(election.options);
var turnCount=2016;
function changeOptions(countryName,map)
{
  console.log("it's " + countryName);
  document.getElementById('radio1text').innerHTML = "Attempt to expand the bandwidth";
  document.getElementById('radio2text').innerHTML = "Attempt to expand the bandwidth";
  document.getElementById('radio3text').innerHTML = "Attempt to expand the bandwidth";
  document.getElementById('radio4text').innerHTML = "Attempt to expand the bandwidth";
}

function advanceTurn()
{

  turnCount++;
  document.getElementById("turn-count").innerHTML=turnCount;
}


//resizing 
window.addEventListener('resize', function() {
        election.resize();
    });
/*
election.updateChoropleth({
   USA: '#0283f4',
   CAN: '#0283f4',
   CHN: '#0283f4'
});
  */ 
     </script>
</body>